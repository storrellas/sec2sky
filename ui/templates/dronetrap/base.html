
{% load static %}
<!DOCTYPE html>
<html>

<head>
    <link rel="icon" href="{% static 'img/favicon.jpg' %}">
    <title>{% block title %}SEC2SKY{% endblock title %}</title>

    <!-- Bootstrap + FontAwesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
      integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/dronetrap.css' %}">



    <style type="text/css">
    /*!
     * Start Bootstrap - Simple Sidebar (https://startbootstrap.com/template-overviews/simple-sidebar)
     * Copyright 2013-2017 Start Bootstrap
     * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-simple-sidebar/blob/master/LICENSE)
     */

    body {
      overflow-x: hidden;
    }

    #wrapper {
      padding-left: 0;
      -webkit-transition: all 0.5s ease;
      -moz-transition: all 0.5s ease;
      -o-transition: all 0.5s ease;
      transition: all 0.5s ease;
    }

    #wrapper.toggled {
      padding-left: 250px;
    }

    #sidebar-wrapper {
      z-index: 1000;
      position: fixed;
      left: 250px;
      width: 0;
      height: 100%;
      margin-left: -250px;
      overflow-y: auto;
      -webkit-transition: all 0.5s ease;
      -moz-transition: all 0.5s ease;
      -o-transition: all 0.5s ease;
      transition: all 0.5s ease;
    }

    #wrapper.toggled #sidebar-wrapper {
      width: 250px;
    }

    #page-content-wrapper {
      width: 100%;
      position: absolute;
      padding: 15px;
      margin-top: 60px;
    }

    #wrapper.toggled #page-content-wrapper {
      position: absolute;
      margin-right: -250px;
    }


    /* Sidebar Styles */
    .sidebar-nav {
      position: absolute;
      top: 0;
      width: 250px;
      margin: 0;
      padding: 0;
      list-style: none;
    }

    .sidebar-nav li {
      text-indent: 20px;
      line-height: 40px;
    }

    .sidebar-nav li a {
      display: block;
      text-decoration: none;
      color: #999999;
    }

    .sidebar-nav li a:hover {
      text-decoration: none;
      color: #fff;
      background: rgba(255, 255, 255, 0.2);
    }

    .sidebar-nav li a:active, .sidebar-nav li a:focus {
      text-decoration: none;
    }

    .sidebar-nav>.sidebar-brand {
      height: 65px;
      font-size: 18px;
      line-height: 60px;
    }

    .sidebar-nav>.sidebar-brand a {
      color: #999999;
    }

    .sidebar-nav>.sidebar-brand a:hover {
      color: #fff;
      background: none;
    }

    .sidebar-nav .sidebar-item span {
      padding-left:1.5em
    }

    @media(min-width:768px) {
      #wrapper {
        padding-left: 0;
      }
      #wrapper.toggled {
        padding-left: 250px;
      }
      #sidebar-wrapper {
        width: 0;
      }
      #wrapper.toggled #sidebar-wrapper {
        width: 250px;
      }
      #page-content-wrapper {
        padding: 50px;
        position: relative;
      }
      #wrapper.toggled #page-content-wrapper {
        position: relative;
        margin-right: 0;
      }
    }
    </style>

    {% block header_page %}
    {% endblock header_page %}

</head>

<body>

  <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
        <a href="#menu-toggle" class="btn btn-dark" id="menu-toggle"><i class="fa fa-bars"></i></a>
        <a class="brand" href="/"><img src="{% static 'img/logo_white.png' %}" height=50px></a>
      </div>
      <div class="mx-auto order-0">
        <span class="d-none circled">0</span>
        <span class="badge badge-success" style="padding: 1em">NO ALERTS</span>
      </div>
      <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
          <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                  <a class="nav-link" href="/setings/"><i class="fa fa-bell fa-fw"></i>  <strong>ALERTS</strong></a>
              </li>

              <li class="nav-item">
                  <a class="nav-link" href="/setings/"><i class="fa fa-user fa-fw"></i>  <strong>SETTINGS</strong></a>
              </li>

              <li class="nav-item dropdown account-item">
                  <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">
                      <i class="fa fa-user fa-fw"></i> <strong></strong>
                  </a>
                  <ul class="dropdown-menu dropdown-user">
                      <li>
                        <a class="dropdown-item" href="{% url 'ui-profile' %}">
                          <i class="fa fa-user fa-fw"></i> Profile
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item logout-btn" href="#">
                          <i class="fa fa-sign-out-alt fa-fw"></i> Logout
                        </a>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
  </nav>




  <div id="wrapper" class="toggled">

      <!-- Sidebar -->
      <div id="sidebar-wrapper" class="bg-dark">
          <ul class="sidebar-nav">
              <li class="sidebar-brand">
                  <a href="#">
                      Main Menu
                  </a>
              </li>
              <li class="sidebar-item company-item">
                <a href="{% url 'ui-company' %}">
                  <i class="fa fa-building fa-fw"></i><span>Company</span>
                </a>
              </li>
              <li class="sidebar-item user-item">
                <a href="{% url 'ui-user' %}">
                  <i class="fa fa-user fa-fw"></i><span>User</span>
                </a>
              </li>
              <li class="sidebar-item swarm-item">
                <a href="{% url 'ui-swarm' %}">
                  <i class="fa fa-atom fa-fw"></i><span>Swarm</span>
                </a>
              </li>
              <li class="sidebar-item sensor-item">
                <a href="{% url 'ui-sensor' %}">
                  <i class="fa fa-broadcast-tower fa-fw"></i><span>Sensor</span>
                </a>
              </li>
              <li class="sidebar-item console-item">
                <a href="{% url 'ui-console' %}">
                  <i class="fa fa-map-marked fa-fw"></i><span>Map</span>
                </a>
              </li>
          </ul>
      </div>

      <div id="page-content-wrapper">
          {% block content %}
              OPS! error en integraci√≥n de plantillas con Base...
          {% endblock content %}
      </div>

  </div>



  <!-- JQuery/Bootstrap/Popper-->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
  <script src="{% static 'js/utils.js' %}"></script>

  <script type="text/javascript">

    $(document).ready(function () {

      // Check for credentials
      const jwt_refresh = CookieMgr.get('jwt_refresh');
      $.ajax({
        type: "POST",
        url: "/api/token/refresh/",
        data: JSON.stringify({ refresh: jwt_refresh }),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(data){
          // Update token
          CookieMgr.set('jwt_token', data.access)
        },
        error: () => window.location = '/ui/',
        failure: () => window.location = '/ui/'
      })


      $('.logout-btn').click(function(){
        CookieMgr.erase('jwt_token');
        CookieMgr.erase('jwt_refresh');
        window.location = '/ui/';
      });

      $("#menu-toggle").click(function(e) {
          e.preventDefault();
          $("#wrapper").toggleClass("toggled");
      });

      // Decode Token
      const token_access = CookieMgr.get('jwt_token');
      const jwt = JWTMgr.parse(token_access)
      $('.account-item strong').text("hello! " + jwt.username.toUpperCase())
      if(jwt.role == "administrator"){
        // Nothint to do
      }else{
        // Remove menu index
        $('.company-item').hide()
        $('.user-item').hide()
      }
    });
  </script>

  {% block footer_page %}
  {% endblock footer_page %}

</body>

</html>
